TryHackMe | OWASP Top 10

> Caleb C | 2022-2-17

------------

(OWASP 10)[https://tryhackme.com/room/owasptop10]

Tips on boxes
Commands to try

Linux
```bash
whoami
id
ifconfig/ip addr
uname -a
ps -ef
```
Windows
```cmd
whoami
ver
ipconfig
tasklist
netstat -an
```
## Severity 1 - Command Injection Practical

1. What strange text file is in the website root directory?
> ls
> drpepper.txt

2. How many non-root/non-service/non-daemon users are there?
> cat /etc/passwd
> 0

3. What user is this app running as?
> whoami
> www-data

4. What is the user's shell set as?
> cat /etc/passwd
> /usr/sbin/nologin

5. What version of Ubuntu is running?
> lsb_release -a
> 18.04.4

6. Print out the MOTD.  What favorite beverage is shown?
> cat /etc/update-motd.d/00-header
> Dr Pepper

## Severity 2 - Broken Authentication Practical 

1. What is the flag that you found in darren's account?
> fe86079416a21a3c99937fea8874b667

2. What is the flag that you found in arthur's account?
> d9ac0f7db4fda460ac3edeb75d75e16e

## Severity 3 - Sensitive Data Exposure (intro)


Have a look around the webapp. The developer has left themselves a note indicating that there is sensitive data in a specific directory. 

1. What is the name of the mentioned directory?
> /assets
This was found by looking in the chrome dev tools to find a HTML comment of where the directory was located.

2. Navigate to the directory you found in question one. What file stands out as being likely to contain sensitive data?
> webapp.db
Located at IP/assets

3. Use the supporting material to access the sensitive data. What is the password hash of the admin user?
> 6eea9b7ef19179a06954edd0f6c05ceb
After downloading the webapp.db, query the file with `file webapp.db` to find it is a SQlite3 Database file.
`sqlite> .tables
sqlite> PRAGMA table_info(users);
sqlite> SELECT * from users`

4. What is the admin's plaintext password?
> qwertyuiop
Use `cracksation` website to enter weak MD5 hashed password from `webapp.db`

5. Login as the admin. What is the flag?
> THM{Yzc2YjdkMjE5N2VjMzNhOTE3NjdiMjdl}

## Severity 4 - XML External Entity

Every XML document mostly starts with what is known as XML Prolog.
`<?xml version="1.0" encoding="UTF-8"?>`

